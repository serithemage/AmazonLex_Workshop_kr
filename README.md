

# Amazon Lex 한국어 뱅킹 챗봇 빌드 워크숍

Amazon Lex 한국어 뱅킹 챗봇 빌드 워크숍에 오신것을 환영합니다!

이 워크숍은 여러분이 Amazon Lex를 이용해 한국어로 동작하는 챗봇을 만들기 위해 필요한 지식들을 빠르게 익힐 수 있도록 구성되었 습니다. 

## Amazon Lex란?

Amazon Lex 는 음성 및 텍스트를 사용하여 모든 애플리케이션에 대화형 인터페이스를 구축하기 위한 서비스입니다. Amazon Lex는 음성을 텍스트로 변환하는 자동 음성 인식(ASR)과 텍스트의 의도를 인식하는 자연어 이해(NLU)의 고급 딥 러닝 기능을 제공하여 매우 매력적인 사용자 경험과 생생한 대화로 애플리케이션을 구축할 수 있도록 합니다. 상호 작용. Amazon Lex를 통해 이제 Amazon Alexa를 지원하는 동일한 딥 러닝 기술을 모든 개발자가 사용할 수 있으므로 정교한 자연어 대화형 봇을 빠르고 쉽게 구축할 수 있습니다.

완전 관리형 서비스인 Amazon Lex는 자동으로 확장되므로 인프라 관리에 대해 걱정할 필요가 없습니다.

### Lex V2 출시 

2021년 1월 출시된 새로운 Amazon Lex V2 콘솔을 통해 봇을 더 쉽게 구축, 배포 및 관리할 수 있습니다. 이 워크숍에서는 Lex V2 콘솔을 이용해 Amazon Lex 콘솔 및 API를 사용하는 방법, 기본 봇 구축 개념, 간단한 봇을 생성하는 방법에 대해 배우게 됩니다. 

새로운 Amazon Lex V2 콘솔 및 API에는 봇 빌드를 단순화하는 데 도움이 되는 여러 가지 새로운 기능이 도입되었습니다.

- 언제든지 봇에 새 언어를 추가하고 단일 리소스로 설계, 테스트 및 배포의 수명 주기를 통해 모든 언어를 관리할 수 있습니다. 새로운 콘솔 대시보드를 사용하면 다른 언어 간에 빠르게 이동하여 대화를 비교하고 구체화할 수 있습니다.
- Amazon Lex API는 의도 및 슬롯 유형이 특정 언어로 범위가 지정되는 단순화된 정보 아키텍처를 따릅니다. 인텐트 및 슬롯 유형과 같은 리소스의 버전을 개별적으로 지정할 필요가 없도록 버전 관리는 봇 수준에서 수행됩니다.
- Amazon Lex 콘솔은 봇 설계 프로세스를 보다 유연하게 제어하고 제어할 수 있는 추가 빌더 생산성 도구 및 기능을 제공합니다. 예를 들어, 이제 구성을 스크립트, 테스트 및 조정할 때 부분적으로 완료된 작업을 저장할 수 있습니다. 새로운 대화 흐름 섹션을 사용하여 각 의도에 대한 발화 및 슬롯 유형을 볼 수도 있습니다 .

### 이 워크숍의 목표 - 뱅킹 봇 구축

이 워크숍에서는 Amazon Lex의 특징을 직접 사용하면서 학습 하도록 설계 되었습니다. 이 워크숍에서는 다중 인텐트 및 Lambda를 이용한 처리 후크를 포함한 Lex의 핵심 기능을 이용해 뱅킹 봇을 구축합니다.


## 워크숍 준비

### AWS 계정 생성

이 실습을 진행하기 위해서는 관리자 권한(AdministratorAccess)을 가진 IAM 사용자가 필요합니다. AWS계정이 없거나 IAM사용자가 없을경우 아래 링크를 참고하여 계정을 만드시기 바랍니다.

- [AWS 가입하기](https://aws.amazon.com/ko/premiumsupport/knowledge-center/create-and-activate-aws-account/)
- [관리자 권한을 가진 IAM 사용자 만들기](https://docs.aws.amazon.com/ko_kr/systems-manager/latest/userguide/setup-create-admin-user.html)

### 봇 관련 용어 설명

![용어설명](images/basics-main-ideas.kr.png)

1. 의도 - 사용자가 수행하려는 작업입니다. 이를 통해 봇은 사용자가 수행하려는 작업을 이해하고 분류할 수 있습니다. 단일 봇은 여러 개의 다른 의도를 포함할 수 있으므로 하나의 봇이 사용자의 서로 다르지만 가장 유사한 관련 요청을 처리할 수 있습니다.
1. 발화 - 의도를 트리거하기 위해 사용자가 입력하거나 말해야 하는 내용의 텍스트 표현입니다. 하나의 인텐트에는 다양한 발언이 포함될 수 있으므로 사용자가 다양한 구문을 사용하여 봇을 트리거하고 발언과 함께 다양한 데이터 매개변수(또는 "슬롯")를 제공할 수 있습니다.
1. 프롬프트 - Lex는 은행 계좌 번호나 항공편 예약 날짜를 요청할 때와 같이 대화의 여러 단계에 대해 다른 프롬프트를 정의할 수 있습니다. 또한 Lambda 함수에 의해 런타임에 재정의될 수 있습니다.
1. 슬롯 - 봇이 작업을 수행하기 위해 필요한 데이터 항목입니다. 예를 들어 항공편 예약 의도의 경우 출발지 공항, 도착지 공항, 비행 날짜, 비행 시간 및 예약 클래스에 대한 슬롯이 필요할 수 있습니다. Lex에는 많은 내장 슬롯 유형이 있지만 사용 사례에 맞게 사용자 정의 슬롯 유형을 자유롭게 생성할 수 있습니다.
1. 이행 - 종료 메시지와 사용자에 대한 몇 가지 추가 정보가 있는 봇의 최종 출력 메세지 입니다. 예를 들어 항공편 예약의 경우 이행에는 사용자가 예약한 경로 및 항공편 번호에 대한 간략한 요약과 함께 항공편이 예약되었음을 확인할 수 있는 메시지가 출력됩니다.

---
(수정중)

- 봇 - 봇은 피자 주문이나 호텔 예약, 꽃 주문과 같은 작업을 텍스트 또는 음성 인터페이스를 사용하여 자동화 합니다.
  - 역할 - 봇이 동작하기 위해 필요한 권한을 IAM역할을 통해 부여 할 수 있습니다. 
  - 유휴 세션 제한시간 - 세션을 유지하는 기간을 선택합니다. 세션 기간 동안 봇이 동일한 변수로 대화를 진행할 수 있도록 세션 변수를 유지합니다.
  - 정보 수집 및 COPPA(Children's Online Privacy Protection Act) 적용  
    Amazon Lex는 문제 해결 및 서비스 개선을 위해 고객 콘텐츠를 수집합니다. 고객 콘텐츠는 기본적으로 보호되며 Amazon Lex API를 사용하여 개별 고객의 콘텐츠를 삭제할 수 있습니다.  
    Amazon Lex는 네 가지 유형의 콘텐츠를 저장합니다.  
      - 봇을 빌드하고 훈련하는 데 사용되는 샘플 발언
      - 봇과 상호 작용하는 사용자의 고객 발언
      - 사용자가 봇과 상호 작용하는 동안 애플리케이션별 정보를 제공하는 세션 속성
      - 봇에 대한 단일 요청에 적용되는 정보가 포함된 요청 속성
    미국에 기반을 둔 회사가 13세 이하 어린이를 대상으로 한 봇을 제공하고자 하는 경우 콘솔 또는 Amazon Lex API를 사용하여 childDirected필드를 true로 설정하여 봇이 어린이 온라인 개인정보 보호법(COPPA)의 적용을 받는다고 Amazon Lex에 알립니다. childDirected필드가 true로 설정 되면 사용자 발언이 저장되지 않습니다.

  - 언어  
    Amazon Lex 한국어를 포함해 13개 언어를 지원합니다.  Amazon Lex가 지원하는 언어에 대한 정보는 [Amazon Lex가 지원하는 언어](https://docs.aws.amazon.com/lex/latest/dg/how-it-works-language.html)에서 확인하실 수 있습니다. Amazon Lex는 동시에 여러 언어를 사용할 수 있도록 복수의 언어를 음성 상호 작용에 추가하는것이 가능합니다. 
    - 음성 상호 작용  
      봇이 사용자와 상호 작용하는 데 사용하는 텍스트 투 스피치 음성입니다. 한국어의 경우 polly의 한국어 음성인 서연(Seoyeon)이 선택됩니다.

    - 의도 분류 신뢰도 점수 임계값

      사용자가 발언을 하면 Amazon Lex는 자연어 이해(NLU)를 사용하여 사용자의 요청을 이해하고 적절한 의도를 반환합니다. 기본적으로 Amazon Lex는 봇이 정의한 가능성이 가장 높은 의도를 반환합니다.

      Amazon Lex가 반환하는 신뢰도 점수는 0부터 1사이의 숫자로 여러 의도를 비교하기 위한 상대 값 입니다. 이 값은 Amazon Lex가 개선됨에 따라 변경될 수 있습니다.

- 의도(Intent) - 의도는 사용자가 수행하려는 작업을 나타냅니다. 하나 이상의 관련 인텐트를 지원하는 봇을 만듭니다. 예를 들어 피자와 음료를 주문하는 인텐트를 만들 수 있습니다. 각 의도에 대해 다음 필수 정보를 제공합니다.

  - 대화 흐름 - 대화 흐름을 사용하여 봇과 사용자 간의 대화를 시각화할 수 있습니다. 다른 대화 상자 노드를 선택하여 의도 내에서 탐색할 수 있습니다. 의도에 대한 확인 프롬프트 및 종료 응답 등의 다른 대화 상자 노드를 추가하면 흐름이 자동으로 생성됩니다.
  - 샘플 표현 - 이 의도를 호출하기 위해 사용자가 말하거나 입력할 것으로 예상되는 대표적인 구문입니다. Amazon Lex는 샘플과 다를 수 있는 사용자 입력을 해석하기 위해 샘플 표현을 기반으로 추정합니다. 샘플 표현의 우선순위는 의도 분류 출력을 결정하는 데 사용되지 않습니다.
  - 슬롯 - 봇이 의도를 이행하는 데 필요한 정보입니다. 봇이 아래 우선순위에 따라 의도 이행에 필요한 슬롯을 묻는 프롬프트를 표시합니다.
  - 슬롯 유형 - Lex는 도시나 나라 날짜, 숫자등을 입력받기 위한 슬롯을 기본으로 제공합니다. 기본으로 제공되는 슬롯 이외에 직접 [슬롯 유형을 추가](https://docs.aws.amazon.com/lexv2/latest/dg/build-slot-types.html)하는것도 가능합니다.
  - 확인 프롬프트 및 거부 응답 - 프롬프트는 의도를 확인하고자 할 때 이용합니다. 예를들어, 식사를 주문하는 봇을 만들었을때 확인 프롬프트에 "준문을 진행하시겠습니까?"라는 문장을 넣어 의도를 확인토록 할 수 있습니다. 사용자가 확인 프롬프트를 거부하는 경우 lex가 어떤 응답을 해야 하는지도 정할 수 있는데 이를 거부 응답이라고 합니다. 식사 주문을 예로 들자면 "주문을 진행하지 않고 종료합니다."와 같은 문장을 설정할 수 있습니다.
  - Fulfillment - Lambda 함수의 실행이 완료된 경우 사용자에게 이를 알리기 위해 설정합니다. 성공하였을 경우의 문구는 **On successful fulfillment**에 설정하고 실패하는 경우의 문구는 **In case of failure**에 설정합니다.

  - 응답을 닫는 중 - 의도를 닫을 때 lex가 사용자에게 보내는 응답을 정의할 수 있습니다.
  - 코드 후크
    - 초기화 및 검증에 Lambda 함수 사용 - Lambda 함수는 대화의 모든 전환에서 실행됩니다. 이 함수를 사용하여 값을 초기화하거나 사용자 입력을 검증할 수 있습니다.